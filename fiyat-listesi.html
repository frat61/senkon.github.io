<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <title>ŞENTÜRK Fiyat Listesi – Özet Matris</title>

  <style>
    :root {
      --senturk-navy: #1b2533;
      --senturk-orange: #f07530;
      --border-light: #dcdcdc;
      --text-muted: #666;
      --bg-light: #f7f7f7;
      --footer-bordo: #7b1f22;
    }

    body {
      margin: 0;
      padding: 24px;
      background: #e6e6e6;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI",
                   "Helvetica Neue", Arial, "Noto Sans", sans-serif;
    }

    .page {
      max-width: 1000px;
      margin: auto;
      background: white;
      padding: 24px 32px 32px;
      box-shadow: 0 0 12px rgba(0,0,0,0.12);
    }

    /* HEADER */
    .header {
      display: flex;
      justify-content: space-between;
      align-items: flex-end;
      margin-bottom: 12px;
    }

    .senturk-logo img {
      height: 50px;
      width: auto;
    }

    .marshall-logo img {
      height: 50px;
      width: auto;
    }

    /* SUBHEADER */
    .subheader {
      margin-top: 6px;
      padding-top: 8px;
      margin-bottom: 8px;
      border-top: 1px solid #000;
      font-weight: 600;
      text-align: center;
      color: var(--senturk-navy);
    }

    .editable-title {
      display: inline-block;
      padding: 0 4px;
      min-width: 80px;
      border-bottom: 1px dashed #ccc;
      cursor: text;
    }

    .editable-title:focus {
      outline: 2px solid #ffd27f;
    }

    /* LEGEND */
    .legend {
      margin-bottom: 12px;
      font-size: 11px;
      color: var(--text-muted);
      display: flex;
      flex-wrap: wrap;
      gap: 6px 10px;
      align-items: center;
    }

    .legend-title {
      font-weight: 600;
      color: var(--senturk-navy);
      margin-right: 4px;
    }

    .legend-item {
      display: inline-flex;
      align-items: center;
      gap: 4px;
      white-space: nowrap;
    }

    .legend-swatch {
      width: 10px;
      height: 10px;
      border-radius: 2px;
      background: #ccc;
      border: 1px solid rgba(0,0,0,0.2);
    }

    /* TOOLBAR */
    .toolbar {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 12px;
      gap: 8px;
      flex-wrap: wrap;
      font-size: 13px;
    }

    .toolbar-left {
      display: flex;
      align-items: center;
      gap: 8px;
      flex-wrap: wrap;
    }

    .toolbar-right {
      display: flex;
      align-items: center;
      gap: 8px;
      flex-wrap: wrap;
    }

    input[type="file"] {
      padding: 4px 6px;
      border: 1px solid #ccc;
      border-radius: 4px;
      font-size: 12px;
    }

    .toolbar button {
      padding: 6px 10px;
      border-radius: 4px;
      border: none;
      background: var(--senturk-navy);
      color: #fff;
      font-size: 12px;
      cursor: pointer;
    }

    .toolbar button:hover { opacity: 0.9; }

    #searchInput {
      padding: 4px 8px;
      border-radius: 4px;
      border: 1px solid #ccc;
      font-size: 12px;
      min-width: 180px;
    }

    #searchInput::placeholder { color: #999; }

    /* CONTENT LAYOUT */
    #content {
      column-count: 2;
      column-gap: 16px;
    }

    @media (max-width: 900px) {
      #content { column-count: 1; }
    }

    .group-block {
      break-inside: avoid;
      page-break-inside: avoid;
      margin-bottom: 8px;
    }

    /* TABLE */
    table.price-matrix {
      width: 100%;
      border-collapse: collapse;
      font-size: 11px;
      table-layout: fixed;
      margin-bottom: 4px;
    }

    th, td {
      padding: 4px 4px;
      border: 1px solid var(--border-light);
      white-space: nowrap;
      vertical-align: middle;
      text-align: center;
    }

    th {
      background: var(--bg-light);
      font-weight: 600;
    }

    td.col-price {
      font-weight: 600;
      font-size: 10px;
    }

    table.price-matrix col.col-product { width: 30%; }
    table.price-matrix col.col-color   { width: 18%; }

    td.col-product,
    td.col-color {
      white-space: normal !important;
      word-break: break-word;
      line-height: 1.25;
    }

    /* CATEGORY STRIPE */
    table.price-matrix td.col-product {
      position: relative;
      border-left: none !important;
    }

    table.price-matrix td.col-product::before {
      content: "";
      position: absolute;
      left: 0; top: 0;
      width: 4px;
      height: 100%;
      background: var(--stripe-color, var(--senturk-orange));
    }

    tbody tr:nth-child(odd) { background-color: #ffffff !important; }
    tbody tr:nth-child(even){ background-color: #f5f5f5 !important; }

    /* FOOTER */
    .footer {
      margin-top: 18px;
      padding-top: 8px;
      border-top: 4px solid var(--footer-bordo);
      font-size: 11px;
      color: var(--footer-bordo);
      text-align: center;
      line-height: 1.4;
    }

    .footer .line { margin: 2px 0; }

    @media print {

      body { background: white; margin: 0; padding: 0; }
      .page { box-shadow: none; margin: 0; max-width: 100%; }
      .toolbar { display: none !important; }

      .group-block, table, tr, td, th {
        page-break-inside: avoid !important;
      }

      .subheader {
        border-top: none;
        margin-top: 0;
        padding-top: 0;
      }

      .price-matrix thead { display: table-header-group; }

      /* DESKTOP PRINT */
      body.desktop-print .page { padding: 10mm 8mm 10mm; }
      body.desktop-print #content { column-count: 2; column-gap: 8px; }
      body.desktop-print table.price-matrix { font-size: 9px; }
      body.desktop-print th, body.desktop-print td { padding: 2px 2px; }
      body.desktop-print td.col-price { font-size: 8px; }

      /* MOBILE PRINT */
      body.mobile-print .page { padding: 8mm 6mm 8mm; }
      body.mobile-print #content { column-count: 1; }
      body.mobile-print table.price-matrix { font-size: 11px; }
    }
  </style>

  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
</head>

<body>
<div class="page">

  <!-- HEADER -->
  <div class="header">
    <div class="senturk-logo">
      <img src="senturk_logo.png" alt="Şentürk">
    </div>
    <div class="marshall-logo">
      <img src="marshall_logo.png" alt="Marshall">
    </div>
  </div>

  <!-- SUBHEADER -->
  <div class="subheader">
    <span id="titleLabel" contenteditable="true" class="editable-title">
      ÖZET FİYAT LİSTESİ
    </span>
    &nbsp;–&nbsp;
    <span id="monthLabel" contenteditable="true" class="editable-title"></span>
  </div>

  <!-- LEGEND -->
  <div id="legend" class="legend"></div>

  <!-- TOOLBAR -->
  <div class="toolbar">
    <div class="toolbar-left">
      <label for="excelInput">Excel Yükle:</label>
      <input type="file" id="excelInput" accept=".xlsx,.xls">
    </div>

    <div class="toolbar-right">
      <input type="text" id="searchInput" placeholder="Ürün / renk ara...">
      <button id="clearSearchBtn">Temizle</button>
      <button onclick="printDesktop()">A4 / Standart Yazdır</button>
      <button onclick="printMobile()">Telefon için Yazdır</button>
    </div>
  </div>

  <!-- CONTENT -->
  <div id="content"></div>

  <!-- FOOTER -->
  <div class="footer">
    <div class="line">
      Şentürk Boya İnş. Tur. San. Tic. Ltd. Şti. —
      Adres : Petrol İş Mah. Kızılay Bulvarı Efe Sok. No:4 Toprakyol Kartal / İstanbul
    </div>
    <div class="line">
      Telefon: 0216 - 473 78 90 —
      Fax : 0216 - 473 78 93 —
      info@senturkboya.com
    </div>
  </div>

</div>

<script>
/* your JavaScript remains exactly the same — unchanged */
</script>

</body>
</html>
